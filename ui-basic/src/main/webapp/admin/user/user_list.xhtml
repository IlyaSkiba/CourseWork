<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
<f:view id="userCard">
    <h:head>
        <title>Статистика</title>
        <h:outputStylesheet library="css" name="global.css"/>
    </h:head>
    <h:body>
        <ui:decorate template="../structure.xhtml">
            <ui:define name="content">
                <h:form id="userListForm">
                    <p:ajaxStatus style="width:64px;height:64px;position:fixed;right:5px;bottom:5px">
                        <f:facet name="start">
                            <p:graphicImage value="/resources/images/loading.gif"/>
                        </f:facet>

                        <f:facet name="complete">
                            <h:outputText value=""/>
                        </f:facet>
                    </p:ajaxStatus>
                    <p:dataTable id="userList"
                                 var="user"
                                 value="#{userAdminModel.users}"
                                 paginator="true" rows="10"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="5,10,15"
                                 rowKey="#{user.userId}">

                        <p:column headerText="Фамилия"
                                  sortBy="#{user.lastName.toLowerCase()}"
                                  filterBy="#{user.lastName}"
                                  styleClass="user-list user-owner-column">
                            <h:outputText style="width:100%" value="#{user.lastName}"/>
                        </p:column>

                        <p:column headerText="Имя"
                                  sortBy="#{user.firstName.toLowerCase()}"
                                  styleClass="user-list user-name-column"
                                  filterBy="#{user.firstName}">
                            <h:outputText value="#{user.firstName}"/>
                        </p:column>

                        <p:column headerText="Фамилия"
                                  sortBy="#{user.middleName.toLowerCase()}"
                                  filterBy="#{user.middleName}"
                                  styleClass="user-list user-owner-column">
                            <h:outputText style="width:100%" value="#{user.middleName}"/>
                        </p:column>

                        <p:column headerText="Назначенные роли"
                                  styleClass="user-list user-owner-column">
                            <h:outputText style="width:100%" value="#{userAdminModel.viewRoles(user)}"/>
                        </p:column>
                        <p:column styleClass="user-list user-action-column">
                            <p:commandButton id="editButton" icon="ui-icon ui-icon-pencil" update=":edituserForm"
                                             oncomplete="edituser.show()">
                                <!--<f:setPropertyActionListener value="#{user}" target="#{userAdmin.userEdit}"/>-->
                            </p:commandButton>
                            <p:commandButton id="deleteButton" icon="ui-icon ui-icon-trash" update="@none"
                                             oncomplete="deleteuserDialog.show()">
                                <!--<f:setPropertyActionListener value="#{user}" target="#{userAdmin.userEdit}"/>-->
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>
                </h:form>
                <h:form id="edituserForm">
                    <p:dialog widgetVar="edituser" id="edituserDialog" modal="true" resizable="false" width="500"
                              height="300" dynamic="true">
                    </p:dialog>
                </h:form>
                <h:form id="deleteuserForm">
                    <p:confirmDialog widgetVar="deleteuserDialog"
                                     severity="alert"
                                     closable="false"
                                     header="Удаление курса"
                                     message="Курс будет удален. Вы уверены что хотите продолжить?">
                        <!-- <p:commandButton id="confirm" value="Да" update=":userListForm:userList"
                                          oncomplete="deleteuserDialog.hide()"
                                          action="#{userAdmin.deleteuser()}"/>
                         <p:commandButton id="decline" value="Отмена " onclick="deleteuserDialog.hide()"
                                          type="button"/>-->
                    </p:confirmDialog>
                </h:form>
            </ui:define>
        </ui:decorate>
    </h:body>
</f:view>
</html>